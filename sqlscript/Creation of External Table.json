{
	"name": "Creation of External Table",
	"properties": {
		"content": {
			"query": "--create a database\ncreate database analyticDB\n\n--collate used to encode the string values to UTF8\ncollate Latin1_General_100_Bin2_UTF8\n\nuse analyticDB\nGO\n\n--Creation of master key\ncreate master key encryption by password = 'Raju@321'\n\n--Creating a Scoped Credential\ncreate database scoped credential sastokengrant\nwith IDENTITY = 'SHARED ACCESS SIGNATURE',\nSECRET = 'sv=2022-11-02&ss=bfqt&srt=sco&sp=rwdlacupyx&se=2024-03-07T14:11:51Z&st=2024-03-06T06:11:51Z&spr=https,http&sig=roZzot%2FVE98DZ8MzNmZQZYRS9wZJxom2HF%2BCy5kugrw%3D'\n\n--creation of external Datasource\ncreate external data source datalakesource1\nWITH(\n    LOCATION = 'https://dbdatalakestore2.blob.core.windows.net/',\n    CREDENTIAL = sastokengrant\n)\n\n--creation of external file format\ncreate external file format csvfileformat1\nWITH(\n    FORMAT_TYPE = DELIMITEDTEXT,\n    FORMAT_OPTIONS  (\n        FIELD_TERMINATOR = ',',\n        STRING_DELIMITER = '\"'\n        FIRST_ROW = 2,\n        USE_TYPE_DEFAULT = TRUE\n    )\n)\n\n--creating a new schema for the table\ncreate schema newanalytic\n\n--creation of external table\nCREATE EXTERNAL TABLE newanalytic.car_data\nWITH(\n    LOCATION = 'upload-files/History/CarSales',\n    DATA_SOURCE = datalakesource1,\n    FILE_FORMAT = csvfileformat1\n) \nAS \nSelect car_id, Gender, Company \nfrom \n    OPENROWSET(\n        BULK 'https://dbdatalakestore2.blob.core.windows.net/upload-files/Car_Sales.csv',\n        FORMAT = 'csv',\n        FIRSTROW = 2\n    ) WITH (\n        car_id int,\n        Gender varchar(20),\n        Company varchar(20)\n    )as [Result]",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "analyticDB",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}