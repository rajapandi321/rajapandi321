{
	"name": "Creation of External Table",
	"properties": {
		"content": {
			"query": "--create a database\ncreate database analyticDB\n\n--collate used to encode the string values to UTF8\ncollate Latin1_General_100_Bin2_UTF8\n\nuse analyticDB\nGO\n\n--Creation of master key\ncreate master key encryption by password = 'Raju@321'\n\n--Creating a Scoped Credential\ncreate database scoped credential ManagedIdentity\nwith IDENTITY = 'Managed Identity'\n\n--creation of external Datasource\ncreate external data source datalakesource\nWITH(\n    LOCATION = 'https://dbdatalakestore2.blob.core.windows.net/',\n    CREDENTIAL = ManagedIdentity\n)\n\n--creation of external file format\ncreate external file format csvfileformat\nWITH(\n    FORMAT_TYPE = DELIMITEDTEXT,\n    FORMAT_OPTIONS  (\n        FIELD_TERMINATOR = ',',\n        FIRST_ROW = 2,\n        USE_TYPE_DEFAULT = TRUE\n    )\n)\n\n--creating a new schema for the table\ncreate schema newanalytic\n\n--creation of external table\nCREATE EXTERNAL TABLE newanalytic.car_data\nWITH(\n    LOCATION = 'upload-files/Table/Car_Sales',\n    DATA_SOURCE = datalakesource,\n    FILE_FORMAT = csvfileformat\n) \nAS \nSelect car_id, Gender, Dealer_Name \nfrom \n    OPENROWSET(\n        BULK 'https://dbdatalakestore2.blob.core.windows.net/upload-files/Car Sales.xlsx - car_data.csv',\n        FORMAT = 'csv'\n    ) WITH (\n    car_id INT,\n    Gender VARCHAR(255),\n    Dealer_Name VARCHAR(255)\n) AS [FILE]\n\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "analyticDB",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}